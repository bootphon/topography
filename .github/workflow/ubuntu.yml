name: Ubuntu
on:
  push:
  #   branches:
  #     - main
  # pull_request:


jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - name: "â˜ï¸ checkout repository"
        uses: actions/checkout@v3
        with:
          token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}

      - name: "ğŸ”§ setup Python"
        uses: actions/setup-python@v3
        with:
          python-version: 3.9.x

      - name: "ğŸ update conda environment"
        run: $CONDA/bin/conda env update -n base -f environment.yml

      - name: "ğŸ› ï¸ run isort"
        run: $CONDA/bin/isort . --check-only

      - name: "ğŸ› ï¸ run black"
        run: $CONDA/bin/black --check .

      - name: "ğŸ› ï¸ run flake8"
        run: $CONDA/bin/flake8

      - name: "ğŸ› ï¸ run pylint"
        run: $CONDA/bin/pylint topography

  test:
    runs-on: ubuntu-latest
    steps:
      - name: "â˜ï¸ checkout repository"
        uses: actions/checkout@v3
        with:
          token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}

      - name: "ğŸ”§ setup Python"
        uses: actions/setup-python@v3
        with:
          python-version: 3.9.x

      - name: "ğŸ update conda environment"
        run: $CONDA/bin/conda env update -n base -f environment.yml

      - name: "ğŸ’» pytest"
        run: "$CONDA/bin/pytest"
